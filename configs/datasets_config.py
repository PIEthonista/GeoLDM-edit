import pickle
from configs.constants_colors_radius import get_radius, get_colors


qm9_with_h_atom_decoder = ['H', 'C', 'N', 'O', 'F']
qm9_with_h = {
    'name': 'qm9',
    'atom_encoder': {'H': 0, 'C': 1, 'N': 2, 'O': 3, 'F': 4},
    'atom_decoder': qm9_with_h_atom_decoder,
    # {number of nodes: frequency count}
    'n_nodes': {22: 3393, 17: 13025, 23: 4848, 21: 9970, 19: 13832, 20: 9482, 16: 10644, 13: 3060,
                15: 7796, 25: 1506, 18: 13364, 12: 1689, 11: 807, 24: 539, 14: 5136, 26: 48, 7: 16, 10: 362,
                8: 49, 9: 124, 27: 266, 4: 4, 29: 25, 6: 9, 5: 5, 3: 1},
    'max_n_nodes': 29,
    'atom_types': {1: 635559, 2: 101476, 0: 923537, 3: 140202, 4: 2323},
    'distances': [903054, 307308, 111994, 57474, 40384, 29170, 47152, 414344, 2202212, 573726,
                  1490786, 2970978, 756818, 969276, 489242, 1265402, 4587994, 3187130, 2454868, 2647422,
                  2098884,
                  2001974, 1625206, 1754172, 1620830, 1710042, 2133746, 1852492, 1415318, 1421064, 1223156,
                  1322256,
                  1380656, 1239244, 1084358, 981076, 896904, 762008, 659298, 604676, 523580, 437464, 413974,
                  352372,
                  291886, 271948, 231328, 188484, 160026, 136322, 117850, 103546, 87192, 76562, 61840,
                  49666, 43100,
                  33876, 26686, 22402, 18358, 15518, 13600, 12128, 9480, 7458, 5088, 4726, 3696, 3362, 3396,
                  2484,
                  1988, 1490, 984, 734, 600, 456, 482, 378, 362, 168, 124, 94, 88, 52, 44, 40, 18, 16, 8, 6,
                  2,
                  0, 0, 0, 0,
                  0,
                  0, 0],
    'colors_dic': [get_colors(a) for a in qm9_with_h_atom_decoder],
    'radius_dic': [get_radius(a) for a in qm9_with_h_atom_decoder],
    'with_h': True}
    # 'bond1_radius': {'H': 31, 'C': 76, 'N': 71, 'O': 66, 'F': 57},
    # 'bond1_stdv': {'H': 5, 'C': 2, 'N': 2, 'O': 2, 'F': 3},
    # 'bond2_radius': {'H': -1000, 'C': 67, 'N': 60, 'O': 57, 'F': 59},
    # 'bond3_radius': {'H': -1000, 'C': 60, 'N': 54, 'O': 53, 'F': 53}}



qm9_without_h_atom_decoder = ['C', 'N', 'O', 'F']
qm9_without_h = {
    'name': 'qm9',
    'atom_encoder': {'C': 0, 'N': 1, 'O': 2, 'F': 3},
    'atom_decoder': qm9_without_h_atom_decoder,
    'max_n_nodes': 29,
    'n_nodes': {9: 83366, 8: 13625, 7: 2404, 6: 475, 5: 91, 4: 25, 3: 7, 1: 2, 2: 5},
    'atom_types': {0: 635559, 2: 140202, 1: 101476, 3: 2323},
    'distances': [594, 1232, 3706, 4736, 5478, 9156, 8762, 13260, 45674, 174676, 469292,
                    1182942, 126722, 25768, 28532, 51696, 232014, 299916, 686590, 677506,
                    379264, 162794, 158732, 156404, 161742, 156486, 236176, 310918, 245558,
                    164688, 98830, 81786, 89318, 91104, 92788, 83772, 81572, 85032, 56296,
                    32930, 22640, 24124, 24010, 22120, 19730, 21968, 18176, 12576, 8224,
                    6772,
                    3906, 4416, 4306, 4110, 3700, 3592, 3134, 2268, 774, 674, 514, 594, 622,
                    672, 642, 472, 300, 170, 104, 48, 54, 78, 78, 56, 48, 36, 26, 4, 2, 4,
                    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    'colors_dic': [get_colors(a) for a in qm9_without_h_atom_decoder],
    'radius_dic': [get_radius(a) for a in qm9_without_h_atom_decoder],
    'with_h': False}
    # 'bond1_radius': {'C': 76, 'N': 71, 'O': 66, 'F': 57},
    # 'bond1_stdv': {'C': 2, 'N': 2, 'O': 2, 'F': 3},
    # 'bond2_radius': {'C': 67, 'N': 60, 'O': 57, 'F': 59},
    # 'bond3_radius': {'C': 60, 'N': 54, 'O': 53, 'F': 53}}



qm9_second_half_atom_decoder = ['H', 'C', 'N', 'O', 'F']
qm9_second_half = {
    'name': 'qm9_second_half',
    'atom_encoder': {'H': 0, 'C': 1, 'N': 2, 'O': 3, 'F': 4},
    'atom_decoder': qm9_second_half_atom_decoder,
    'n_nodes': {19: 6944, 12: 845, 20: 4794, 21: 4962, 27: 132, 25: 754, 18: 6695, 14: 2587, 15: 3865, 22: 1701, 17: 6461, 16: 5344, 23: 2380, 13: 1541, 24: 267, 10: 178, 7: 7, 11: 412, 8: 25, 9: 62, 29: 15, 26: 17, 4: 3, 3: 1, 6: 5, 5: 3},
    'atom_types': {1: 317604, 2: 50852, 3: 70033, 0: 461622, 4: 1164},
    'distances': [457374, 153688, 55626, 28284, 20414, 15010, 24412, 208012, 1105440, 285830, 748876, 1496486, 384178, 484194, 245688, 635534, 2307642, 1603762, 1231044, 1329758, 1053612, 1006742, 813504, 880670, 811616, 855082, 1066434, 931672, 709810, 711032, 608446, 660538, 692382, 619084, 544200, 490740, 450576, 380662, 328150, 303008, 263888, 218820, 207414, 175452, 145636, 135646, 116184, 94622, 80358, 68230, 58706, 51216, 44020, 38212, 30492, 24886, 21210, 17270, 13056, 11156, 9082, 7534, 6958, 6060, 4632, 3760, 2500, 2342, 1816, 1726, 1768, 1102, 974, 670, 474, 446, 286, 246, 242, 156, 176, 90, 66, 66, 38, 28, 24, 14, 10, 2, 6, 0, 2, 0, 0, 0, 0, 0, 0, 0],
    'colors_dic': [get_colors(f) for f in qm9_second_half_atom_decoder],
    'radius_dic': [get_radius(f) for f in qm9_second_half_atom_decoder],
    'max_n_nodes': 29,
    'with_h': True}
    # 'bond1_radius': {'H': 31, 'C': 76, 'N': 71, 'O': 66, 'F': 57},
    # 'bond1_stdv': {'H': 5, 'C': 2, 'N': 2, 'O': 2, 'F': 3},
    # 'bond2_radius': {'H': -1000, 'C': 67, 'N': 60, 'O': 57, 'F': 59},
    # 'bond3_radius': {'H': -1000, 'C': 60, 'N': 54, 'O': 53, 'F': 53}}



geom_with_h_atom_decoder = ['H', 'B', 'C', 'N', 'O', 'F', 'Al', 'Si', 'P', 'S', 'Cl', 'As', 'Br', 'I', 'Hg', 'Bi']
geom_with_h = {
    'name': 'geom',
    'atom_encoder': {'H': 0, 'B': 1, 'C': 2, 'N': 3, 'O': 4, 'F': 5, 'Al': 6, 'Si': 7,
    'P': 8, 'S': 9, 'Cl': 10, 'As': 11, 'Br': 12, 'I': 13, 'Hg': 14, 'Bi': 15},
    'atomic_nb': [1,  5,  6,  7,  8,  9, 13, 14, 15, 16, 17, 33, 35, 53, 80, 83],
    'atom_decoder': geom_with_h_atom_decoder,
    'max_n_nodes': 181,
    'n_nodes': {3: 1, 4: 3, 5: 9, 6: 2, 7: 8, 8: 23, 9: 23, 10: 50, 11: 109, 12: 168, 13: 280, 14: 402, 15: 583, 16: 597,
                17: 949, 18: 1284, 19: 1862, 20: 2674, 21: 3599, 22: 6109, 23: 8693, 24: 13604, 25: 17419, 26: 25672,
                27: 31647, 28: 43809, 29: 56697, 30: 70400, 31: 82655, 32: 104100, 33: 122776, 34: 140834, 35: 164888,
                36: 185451, 37: 194541, 38: 218549, 39: 231232, 40: 243300, 41: 253349, 42: 268341, 43: 272081,
                44: 276917, 45: 276839, 46: 274747, 47: 272126, 48: 262709, 49: 250157, 50: 244781, 51: 228898,
                52: 215338, 53: 203728, 54: 191697, 55: 180518, 56: 163843, 57: 152055, 58: 136536, 59: 120393,
                60: 107292, 61: 94635, 62: 83179, 63: 68384, 64: 61517, 65: 48867, 66: 37685, 67: 32859, 68: 27367,
                69: 20981, 70: 18699, 71: 14791, 72: 11921, 73: 9933, 74: 9037, 75: 6538, 76: 6374, 77: 4036, 78: 4189,
                79: 3842, 80: 3277, 81: 2925, 82: 1843, 83: 2060, 84: 1394, 85: 1514, 86: 1357, 87: 1346, 88: 999,
                89: 300, 90: 390, 91: 510, 92: 510, 93: 240, 94: 721, 95: 360, 96: 360, 97: 390, 98: 330, 99: 540,
                100: 258, 101: 210, 102: 60, 103: 180, 104: 206, 105: 60, 106: 390, 107: 180, 108: 180, 109: 150,
                110: 120, 111: 360, 112: 120, 113: 210, 114: 60, 115: 30, 116: 210, 117: 270, 118: 450, 119: 240,
                120: 228, 121: 120, 122: 30, 123: 420, 124: 240, 125: 210, 126: 158, 127: 180, 128: 60, 129: 30,
                130: 120, 131: 30, 132: 120, 133: 60, 134: 240, 135: 169, 136: 240, 137: 30, 138: 270, 139: 180,
                140: 270, 141: 150, 142: 60, 143: 60, 144: 240, 145: 180, 146: 150, 147: 150, 148: 90, 149: 90,
                151: 30, 152: 60, 155: 90, 159: 30, 160: 60, 165: 30, 171: 30, 175: 30, 176: 60, 181: 30},
    'atom_types':{0: 143905848, 1: 290, 2: 129988623, 3: 20266722, 4: 21669359, 5: 1481844, 6: 1,
                  7: 250, 8: 36290, 9: 3999872, 10: 1224394, 11: 4, 12: 298702, 13: 5377, 14: 13, 15: 34},
    'colors_dic': [get_colors(f) for f in geom_with_h_atom_decoder],
    'radius_dic': [get_radius(f) for f in geom_with_h_atom_decoder],
    'with_h': True}



geom_no_h_atom_decoder = ['B', 'C', 'N', 'O', 'F', 'Al', 'Si', 'P', 'S', 'Cl', 'As', 'Br', 'I', 'Hg', 'Bi']
geom_no_h = {
    'name': 'geom',
    'atom_encoder': {'B': 0, 'C': 1, 'N': 2, 'O': 3, 'F': 4, 'Al': 5, 'Si': 6, 'P': 7, 'S': 8, 'Cl': 9, 'As': 10,
                     'Br': 11, 'I': 12, 'Hg': 13, 'Bi': 14},
    'atomic_nb': [5,  6,  7,  8,  9, 13, 14, 15, 16, 17, 33, 35, 53, 80, 83],
    'atom_decoder': geom_no_h_atom_decoder,
    'max_n_nodes': 91,
    'n_nodes': {1: 3, 2: 5, 3: 8, 4: 89, 5: 166, 6: 370, 7: 613, 8: 1214, 9: 1680, 10: 3315, 11: 5115, 12: 9873,
                13: 15422, 14: 28088, 15: 50643, 16: 82299, 17: 124341, 18: 178417, 19: 240446, 20: 308209, 21: 372900,
                22: 429257, 23: 477423, 24: 508377, 25: 522385, 26: 522000, 27: 507882, 28: 476702, 29: 426308,
                30: 375819, 31: 310124, 32: 255179, 33: 204441, 34: 149383, 35: 109343, 36: 71701, 37: 44050,
                38: 31437, 39: 20242, 40: 14971, 41: 10078, 42: 8049, 43: 4476, 44: 3130, 45: 1736, 46: 2030,
                47: 1110, 48: 840, 49: 750, 50: 540, 51: 810, 52: 591, 53: 453, 54: 540, 55: 720, 56: 300, 57: 360,
                58: 714, 59: 390, 60: 519, 61: 210, 62: 449, 63: 210, 64: 289, 65: 589, 66: 227, 67: 180, 68: 330,
                69: 330, 70: 150, 71: 60, 72: 210, 73: 60, 74: 180, 75: 120, 76: 30, 77: 150, 78: 30, 79: 60, 82: 60,
                85: 60, 86: 6, 87: 60, 90: 60, 91: 30},
    'atom_types': {0: 290, 1: 129988623, 2: 20266722, 3: 21669359, 4: 1481844, 5: 1, 6: 250, 7: 36290, 8: 3999872,
                   9: 1224394, 10: 4, 11: 298702, 12: 5377, 13: 13, 14: 34},
    'colors_dic': [get_colors(f) for f in geom_no_h_atom_decoder],
    'radius_dic': [get_radius(f) for f in geom_no_h_atom_decoder],
    'with_h': False}




# too large to put in script
with open('configs/n_nodes__d_20240428_combined_geom_PDBB_full_refined_core_LG_PKT.pkl', 'rb') as file:
    d_20240428_combined_geom_PDBB_full_refined_core_LG_PKT_n_nodes_dict = pickle.load(file)

d_20240428_combined_geom_PDBB_full_refined_core_LG_PKT_atom_decoder = \
    ['H', 'Li', 'Be',  'B',  'C',  'N',  'O',  'F', 'Na', 'Mg',  'Al', 'Si', 'P',  'S',  'Cl', 'K',  'Ca', 'V',  
     'Mn', 'Fe', 'Co', 'Ni', 'Cu', 'Zn', 'Ga',  'As', 'Se',  'Br', 'Rb', 'Sr', 'Ru', 'Rh', 'Cd', 'In', 'Sb', 'Te',  
     'I',  'Cs', 'Ba', 'Re', 'Os', 'Ir', 'Pt', 'Au',  'Hg',  'Bi', 'Og']

d_20240428_combined_geom_PDBB_full_refined_core_LG_PKT = {
    'name': 'combined_geom_PDBB_full_refined_core_LG_PKT',
    'atom_encoder': {'H': 0, 'Li': 1, 'Be': 2, 'B': 3, 'C': 4, 'N': 5, 'O': 6, 'F': 7, 'Na': 8, 'Mg': 9, 'Al': 10, 'Si': 11, 
                     'P': 12, 'S': 13, 'Cl': 14, 'K': 15, 'Ca': 16, 'V': 17, 'Mn': 18, 'Fe': 19, 'Co': 20, 'Ni': 21, 'Cu': 22, 
                     'Zn': 23, 'Ga': 24, 'As': 25, 'Se': 26, 'Br': 27, 'Rb': 28, 'Sr': 29, 'Ru': 30, 'Rh': 31, 'Cd': 32, 'In': 33, 
                     'Sb': 34, 'Te': 35, 'I': 36, 'Cs': 37, 'Ba': 38, 'Re': 39, 'Os': 40, 'Ir': 41, 'Pt': 42, 'Au': 43, 'Hg': 44, 
                     'Bi': 45, 'Og': 46},
    'atomic_nb': [1, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16, 17, 19, 20, 23, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 37, 38, 
                  44, 45, 48, 49, 51, 52, 53, 55, 56, 75, 76, 77, 78, 79, 80, 83, 118],
    'atom_decoder': d_20240428_combined_geom_PDBB_full_refined_core_LG_PKT_atom_decoder,
    'max_n_nodes': 75944,
    'n_nodes': d_20240428_combined_geom_PDBB_full_refined_core_LG_PKT_n_nodes_dict,
    'atom_types': {0: 53453229, 1: 14, 2: 1, 3: 278, 4: 50498410, 5: 12954304, 6: 18703098, 7: 69713, 8: 1398, 9: 3795, 10: 1, 
                   11: 17, 12: 6188, 13: 515574, 14: 56434, 15: 474, 16: 3759, 17: 2, 18: 1126, 19: 276, 20: 218, 21: 278, 22: 65, 
                   23: 5321, 24: 1, 25: 6, 26: 1482, 27: 14585, 28: 3, 29: 2, 30: 16, 31: 2, 32: 506, 33: 1, 34: 1, 35: 1, 36: 417, 
                   37: 15, 38: 1, 39: 1, 40: 1, 41: 6, 42: 2, 43: 6, 44: 95, 45: 3, 46: 2},
    'colors_dic': [get_colors(f) for f in d_20240428_combined_geom_PDBB_full_refined_core_LG_PKT_atom_decoder],
    'radius_dic': [get_radius(f) for f in d_20240428_combined_geom_PDBB_full_refined_core_LG_PKT_atom_decoder],
    'with_h': True
}





# BindingMOAD
# for VAE
d_20240623_BindingMOAD__10A__MaxOcc50__CA_Only__no_H__LIGAND_POCKET_atom_decoder = \
    ['ALA', 'CYS', 'ASP', 'GLU', 'PHE', 'GLY', 'HIS', 'ILE', 'LYS', 'LEU', 'MET', 
     'ASN', 'PRO', 'GLN', 'ARG', 'SER', 'THR', 'VAL', 'TRP', 'TYR', 
     'B', 'C', 'N', 'O', 'F', 'P', 'S', 'V', 'I', 'W'],

d_20240623_BindingMOAD__10A__MaxOcc50__CA_Only__no_H__LIGAND_POCKET = {
    'name': 'd_20240623_BindingMOAD_LG_PKT__10.0A__MaxOcc50__CA_Only__no_H__LIGAND+POCKET',
    'atom_encoder': {'ALA': 0, 'CYS': 1, 'ASP': 2, 'GLU': 3, 'PHE': 4, 'GLY': 5, 'HIS': 6, 'ILE': 7, 'LYS': 8, 'LEU': 9, 'MET': 10, 
                     'ASN': 11, 'PRO': 12, 'GLN': 13, 'ARG': 14, 'SER': 15, 'THR': 16, 'VAL': 17, 'TRP': 18, 'TYR': 19, 
                     'B': 20, 'C': 21, 'N': 22, 'O': 23, 'F': 24, 'P': 25, 'S': 26, 'V': 27, 'I': 28, 'W': 29},
    'atomic_nb': [-20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 5, 6, 7, 8, 9, 15, 16, 23, 53, 74],
    'atom_decoder': d_20240623_BindingMOAD__10A__MaxOcc50__CA_Only__no_H__LIGAND_POCKET_atom_decoder,
    'max_n_nodes': 179,
    'n_nodes': {1: 7, 2: 7, 3: 17, 4: 48, 5: 384, 6: 606, 7: 707, 8: 1036, 9: 1503, 10: 2270, 11: 1899, 12: 2257, 13: 1761, 14: 1552, 15: 1472, 16: 1770, 17: 1224, 18: 1262, 19: 1375, 20: 2032, 21: 2129, 22: 1890, 23: 1685, 24: 1781, 25: 1713, 26: 1440, 27: 1717, 28: 1530, 29: 1557, 30: 1150, 31: 1619, 32: 1491, 33: 1285, 34: 920, 35: 927, 36: 1120, 37: 883, 38: 740, 39: 840, 40: 812, 41: 647, 42: 722, 43: 711, 44: 955, 45: 629, 46: 694, 47: 745, 48: 857, 49: 831, 50: 717, 51: 733, 52: 799, 53: 942, 54: 978, 55: 966, 56: 973, 57: 1057, 58: 1076, 59: 1092, 60: 1145, 61: 1373, 62: 1404, 63: 1503, 64: 1381, 65: 1307, 66: 1284, 67: 1253, 68: 1194, 69: 1211, 70: 1191, 71: 1153, 72: 1207, 73: 1062, 74: 1120, 75: 990, 76: 895, 77: 940, 78: 848, 79: 843, 80: 814, 81: 827, 82: 767, 83: 652, 84: 573, 85: 565, 86: 577, 87: 527, 88: 501, 89: 442, 90: 408, 91: 397, 92: 394, 93: 349, 94: 292, 95: 273, 96: 265, 97: 218, 98: 227, 99: 202, 100: 209, 101: 218, 102: 194, 103: 156, 104: 154, 105: 139, 106: 110, 107: 98, 108: 94, 109: 98, 110: 100, 111: 71, 112: 45, 113: 36, 114: 34, 115: 36, 116: 34, 117: 28, 118: 25, 119: 21, 120: 36, 121: 41, 122: 33, 123: 34, 124: 23, 125: 19, 126: 8, 127: 5, 128: 12, 129: 15, 130: 17, 131: 18, 132: 25, 133: 20, 134: 23, 135: 14, 136: 10, 137: 11, 138: 13, 139: 6, 140: 7, 141: 3, 142: 3, 143: 7, 144: 2, 145: 13, 146: 2, 147: 6, 148: 5, 149: 6, 150: 8, 151: 4, 152: 3, 153: 4, 154: 5, 155: 4, 156: 6, 157: 3, 158: 4, 159: 5, 160: 2, 161: 2, 162: 3, 163: 1, 164: 2, 165: 2, 166: 1, 167: 1, 170: 2, 179: 1},
    'atom_types': {0: 238749, 1: 60324, 2: 171081, 3: 156502, 4: 182510, 5: 289879, 6: 112868, 7: 209755, 8: 129252, 9: 311823, 10: 106180, 11: 143771, 12: 132012, 13: 102341, 14: 158295, 15: 211001, 16: 190624, 17: 241225, 18: 76118, 19: 165968, 20: 681, 21: 755428, 22: 133742, 23: 265841, 24: 10392, 25: 21393, 26: 12747, 27: 36, 28: 496, 29: 2},
    'colors_dic': [get_colors(f) for f in d_20240623_BindingMOAD__10A__MaxOcc50__CA_Only__no_H__LIGAND_POCKET_atom_decoder],
    'radius_dic': [get_radius(f) for f in d_20240623_BindingMOAD__10A__MaxOcc50__CA_Only__no_H__LIGAND_POCKET_atom_decoder],
    'with_h': False
}

# for LDM, ControlNet
d_20240623_BindingMOAD__10A__MaxOcc50__CA_Only__no_H__LIGAND_atom_decoder = \
    ['ALA', 'CYS', 'ASP', 'GLU', 'PHE', 'GLY', 'HIS', 'ILE', 'LYS', 'LEU', 'MET', 
     'ASN', 'PRO', 'GLN', 'ARG', 'SER', 'THR', 'VAL', 'TRP', 'TYR', 
     'B', 'C', 'N', 'O', 'F', 'P', 'S', 'V', 'I', 'W'],

d_20240623_BindingMOAD__10A__MaxOcc50__CA_Only__no_H__LIGAND = {
    'name': 'd_20240623_BindingMOAD_LG_PKT__10.0A__MaxOcc50__CA_Only__no_H__LIGAND',
    'atom_encoder': {'ALA': 0, 'CYS': 1, 'ASP': 2, 'GLU': 3, 'PHE': 4, 'GLY': 5, 'HIS': 6, 'ILE': 7, 'LYS': 8, 'LEU': 9, 'MET': 10, 
                     'ASN': 11, 'PRO': 12, 'GLN': 13, 'ARG': 14, 'SER': 15, 'THR': 16, 'VAL': 17, 'TRP': 18, 'TYR': 19, 
                     'B': 20, 'C': 21, 'N': 22, 'O': 23, 'F': 24, 'P': 25, 'S': 26, 'V': 27, 'I': 28, 'W': 29},
    'atomic_nb': [-20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 5, 6, 7, 8, 9, 15, 16, 23, 53, 74],
    'atom_decoder': d_20240623_BindingMOAD__10A__MaxOcc50__CA_Only__no_H__LIGAND_atom_decoder,
    'max_n_nodes': 140,
    'n_nodes': {1: 4, 2: 5, 3: 16, 4: 47, 5: 378, 6: 602, 7: 701, 8: 1028, 9: 1489, 10: 2255, 11: 1881, 12: 2234, 13: 1733, 14: 1522, 15: 1424, 16: 1709, 17: 1178, 18: 1193, 19: 1305, 20: 1957, 21: 2049, 22: 1802, 23: 1593, 24: 1667, 25: 1585, 26: 1303, 27: 1582, 28: 1381, 29: 1411, 30: 986, 31: 1431, 32: 1272, 33: 1065, 34: 694, 35: 732, 36: 882, 37: 611, 38: 466, 39: 513, 40: 407, 41: 276, 42: 292, 43: 238, 44: 480, 45: 218, 46: 231, 47: 268, 48: 323, 49: 228, 50: 126, 51: 203, 52: 144, 53: 248, 54: 208, 55: 150, 56: 105, 57: 150, 58: 82, 59: 72, 60: 49, 61: 62, 62: 34, 63: 134, 64: 75, 65: 25, 66: 29, 67: 26, 68: 12, 69: 3, 70: 10, 71: 8, 72: 3, 73: 1, 74: 18, 75: 8, 76: 8, 77: 6, 78: 2, 79: 5, 80: 15, 82: 1, 84: 5, 86: 23, 87: 1, 88: 2, 91: 4, 92: 2, 95: 1, 96: 35, 97: 4, 98: 1, 100: 1, 103: 2, 104: 1, 106: 3, 107: 1, 109: 1, 120: 1, 140: 1},
    'atom_types': {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0, 20: 681, 21: 755428, 22: 133742, 23: 265841, 24: 10392, 25: 21393, 26: 12747, 27: 36, 28: 496, 29: 2},
    'colors_dic': [get_colors(f) for f in d_20240623_BindingMOAD__10A__MaxOcc50__CA_Only__no_H__LIGAND_atom_decoder],
    'radius_dic': [get_radius(f) for f in d_20240623_BindingMOAD__10A__MaxOcc50__CA_Only__no_H__LIGAND_atom_decoder],
    'with_h': False
}






# CrossDocked
# for VAE
d_20240623_CrossDocked_LG_PKT__10A__CA_Only__no_H__LIGAND_POCKET_atom_decoder = \
    ['ALA', 'CYS', 'ASP', 'GLU', 'PHE', 'GLY', 'HIS', 'ILE', 'LYS', 'LEU', 'MET', 
     'ASN', 'PRO', 'GLN', 'ARG', 'SER', 'THR', 'VAL', 'TRP', 'TYR', 
     'C', 'N', 'O', 'F', 'P', 'S', 'Cl'],

d_20240623_CrossDocked_LG_PKT__10A__CA_Only__no_H__LIGAND_POCKET = {
    'name': 'd_20240623_CrossDocked_LG_PKT__10A__CA_Only__no_H__LIGAND+POCKET',
    'atom_encoder': {'ALA': 0, 'CYS': 1, 'ASP': 2, 'GLU': 3, 'PHE': 4, 'GLY': 5, 'HIS': 6, 'ILE': 7, 'LYS': 8, 'LEU': 9, 'MET': 10, 
                     'ASN': 11, 'PRO': 12, 'GLN': 13, 'ARG': 14, 'SER': 15, 'THR': 16, 'VAL': 17, 'TRP': 18, 'TYR': 19, 
                     'C': 20, 'N': 21, 'O': 22, 'F': 23, 'P': 24, 'S': 25, 'Cl': 26},
    'atomic_nb': [-20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 6, 7, 8, 9, 15, 16, 17],
    'atom_decoder': d_20240623_CrossDocked_LG_PKT__10A__CA_Only__no_H__LIGAND_POCKET_atom_decoder,
    'max_n_nodes': 184,
    'n_nodes': {1: 1, 2: 5, 3: 6, 4: 45, 5: 111, 6: 710, 7: 656, 8: 1046, 9: 1864, 10: 2887, 11: 3111, 12: 2933, 13: 2189, 14: 2471, 15: 2351, 16: 3165, 17: 2422, 18: 2670, 19: 3207, 20: 4981, 21: 4602, 22: 3518, 23: 4620, 24: 4059, 25: 4892, 26: 5189, 27: 6081, 28: 5399, 29: 3839, 30: 4339, 31: 4119, 32: 4229, 33: 3579, 34: 3333, 35: 3115, 36: 2738, 37: 2483, 38: 2719, 39: 2746, 40: 2953, 41: 3073, 42: 3089, 43: 3100, 44: 3677, 45: 3391, 46: 3567, 47: 3679, 48: 3955, 49: 4005, 50: 3933, 51: 3870, 52: 3766, 53: 3468, 54: 3390, 55: 3014, 56: 2734, 57: 2559, 58: 2451, 59: 2493, 60: 2305, 61: 2041, 62: 1813, 63: 1675, 64: 1623, 65: 1442, 66: 1459, 67: 1292, 68: 1042, 69: 946, 70: 830, 71: 705, 72: 632, 73: 558, 74: 453, 75: 417, 76: 366, 77: 345, 78: 332, 79: 237, 80: 206, 81: 170, 82: 144, 83: 133, 84: 96, 85: 62, 86: 29, 87: 33, 88: 29, 89: 7, 90: 4, 92: 1, 93: 3, 94: 4, 95: 1, 96: 2, 97: 1, 98: 2, 100: 3, 101: 3, 102: 1, 103: 2, 104: 4, 105: 1, 106: 3, 108: 1, 109: 1, 115: 1, 123: 1, 179: 1, 184: 1},
    'atom_types': {0: 350598, 1: 110583, 2: 284233, 3: 219718, 4: 254587, 5: 477815, 6: 158505, 7: 330934, 8: 196195, 9: 473098, 10: 172448, 11: 195735, 12: 185535, 13: 133647, 14: 189282, 15: 327291, 16: 286215, 17: 376426, 18: 92648, 19: 241034, 20: 1585352, 21: 276495, 22: 400601, 23: 30875, 24: 26331, 25: 26552, 26: 15221},
    'colors_dic': [get_colors(f) for f in d_20240623_CrossDocked_LG_PKT__10A__CA_Only__no_H__LIGAND_POCKET_atom_decoder],
    'radius_dic': [get_radius(f) for f in d_20240623_CrossDocked_LG_PKT__10A__CA_Only__no_H__LIGAND_POCKET_atom_decoder],
    'with_h': False
}

# for LDM, ControlNet
d_20240623_CrossDocked_LG_PKT__10A__CA_Only__no_H__LIGAND_atom_decoder = \
    ['ALA', 'CYS', 'ASP', 'GLU', 'PHE', 'GLY', 'HIS', 'ILE', 'LYS', 'LEU', 'MET', 
     'ASN', 'PRO', 'GLN', 'ARG', 'SER', 'THR', 'VAL', 'TRP', 'TYR', 
     'C', 'N', 'O', 'F', 'P', 'S', 'Cl'],

d_20240623_CrossDocked_LG_PKT__10A__CA_Only__no_H__LIGAND = {
    'name': 'd_20240623_CrossDocked_LG_PKT__10A__CA_Only__no_H__LIGAND',
    'atom_encoder': {'ALA': 0, 'CYS': 1, 'ASP': 2, 'GLU': 3, 'PHE': 4, 'GLY': 5, 'HIS': 6, 'ILE': 7, 'LYS': 8, 'LEU': 9, 'MET': 10, 
                     'ASN': 11, 'PRO': 12, 'GLN': 13, 'ARG': 14, 'SER': 15, 'THR': 16, 'VAL': 17, 'TRP': 18, 'TYR': 19, 
                     'C': 20, 'N': 21, 'O': 22, 'F': 23, 'P': 24, 'S': 25, 'Cl': 26},
    'atomic_nb': [-20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 6, 7, 8, 9, 15, 16, 17],
    'atom_decoder': d_20240623_CrossDocked_LG_PKT__10A__CA_Only__no_H__LIGAND_atom_decoder,
    'max_n_nodes': 106,
    'n_nodes': {3: 4, 4: 45, 5: 111, 6: 709, 7: 655, 8: 1043, 9: 1861, 10: 2884, 11: 3104, 12: 2910, 13: 2167, 14: 2439, 15: 2301, 16: 3117, 17: 2384, 18: 2611, 19: 3118, 20: 4890, 21: 4488, 22: 3356, 23: 4446, 24: 3814, 25: 4593, 26: 4770, 27: 5496, 28: 4772, 29: 3143, 30: 3582, 31: 3383, 32: 3314, 33: 2672, 34: 2146, 35: 1852, 36: 1357, 37: 927, 38: 919, 39: 739, 40: 674, 41: 607, 42: 487, 43: 360, 44: 673, 45: 184, 46: 212, 47: 105, 48: 186, 49: 73, 50: 38, 51: 20, 52: 42, 53: 3, 54: 93, 55: 35, 56: 12, 57: 9, 58: 18, 59: 5, 61: 9, 62: 1, 63: 5, 65: 2, 66: 20, 67: 28, 68: 1, 71: 1, 77: 1, 86: 1, 98: 1, 106: 2},
    'atom_types': {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0, 20: 1585352, 21: 276495, 22: 400601, 23: 30875, 24: 26331, 25: 26552, 26: 15221},
    'colors_dic': [get_colors(f) for f in d_20240623_CrossDocked_LG_PKT__10A__CA_Only__no_H__LIGAND_atom_decoder],
    'radius_dic': [get_radius(f) for f in d_20240623_CrossDocked_LG_PKT__10A__CA_Only__no_H__LIGAND_atom_decoder],
    'with_h': False
}






def get_dataset_info(dataset_name, remove_h=False):
    if dataset_name == 'qm9':
        if not remove_h:
            return qm9_with_h
        else:
            return qm9_without_h
    elif dataset_name == 'geom':
        if not remove_h:
            return geom_with_h
        else:
            raise Exception('Missing config for %s without hydrogens' % dataset_name)
    elif dataset_name == 'qm9_second_half':
        if not remove_h:
            return qm9_second_half
        else:
            raise Exception('Missing config for %s without hydrogens' % dataset_name)
    elif dataset_name == 'd_20240428_combined_geom_PDBB_full_refined_core_LG_PKT':
        return d_20240428_combined_geom_PDBB_full_refined_core_LG_PKT
    elif dataset_name == 'd_20240623_BindingMOAD_LG_PKT__10.0A__MaxOcc50__CA_Only__no_H__LIGAND+POCKET' and remove_h == True:
        return d_20240623_BindingMOAD__10A__MaxOcc50__CA_Only__no_H__LIGAND_POCKET
    elif dataset_name == 'd_20240623_BindingMOAD_LG_PKT__10.0A__MaxOcc50__CA_Only__no_H__LIGAND' and remove_h == True:
        return d_20240623_BindingMOAD__10A__MaxOcc50__CA_Only__no_H__LIGAND
    elif dataset_name == 'd_20240623_CrossDocked_LG_PKT__10A__CA_Only__no_H__LIGAND+POCKET' and remove_h == True:
        return d_20240623_CrossDocked_LG_PKT__10A__CA_Only__no_H__LIGAND_POCKET
    elif dataset_name == 'd_20240623_CrossDocked_LG_PKT__10A__CA_Only__no_H__LIGAND' and remove_h == True:
        return d_20240623_CrossDocked_LG_PKT__10A__CA_Only__no_H__LIGAND
    else:
        raise Exception(f"Wrong dataset {dataset_name} with remove_h={remove_h}")
